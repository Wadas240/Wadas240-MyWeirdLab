const canvas = document.getElementById('gravityCanvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏´‡∏•‡πà‡∏ô‡∏•‡∏á‡∏°‡∏≤ (‡πÅ‡∏Å‡πâ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡πÉ‡∏à‡∏ä‡∏≠‡∏ö)
const items = ['‚öΩÔ∏è', 'üèÄ', 'üçé', 'üíé', 'üí©', 'üëΩ', 'üíÄ', 'üßä'];

// ‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏¢‡πå‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
let balls = [];

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏•‡∏≤‡∏™ (‡πÅ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏•‡∏π‡∏Å
class Ball {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = Math.random() * 30 + 20; // ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î 20-50
        this.text = items[Math.floor(Math.random() * items.length)]; // ‡∏™‡∏∏‡πà‡∏°‡∏£‡∏π‡∏õ
        
        // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡πÅ‡∏ï‡∏Å‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏ó‡∏∏‡∏Å‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á)
        this.dx = (Math.random() - 0.5) * 10; 
        this.dy = (Math.random() - 0.5) * 10;
        
        this.gravity = 0.5; // ‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á (‡∏¢‡∏¥‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏¢‡∏¥‡πà‡∏á‡∏ï‡∏Å‡πÄ‡∏£‡πá‡∏ß)
        this.friction = 0.8; // ‡πÅ‡∏£‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏ó‡∏≤‡∏ô (‡πÄ‡∏î‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ö‡∏≤‡∏•‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ)
    }

    update() {
        // ‡∏Å‡∏é‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏Å‡∏ô Y
        this.dy += this.gravity;

        // ‡∏Ç‡∏¢‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß
        this.x += this.dx;
        this.y += this.dy;

        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏û‡∏∑‡πâ‡∏ô (‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)
        if (this.y + this.size > canvas.height) {
            this.y = canvas.height - this.size; // ‡∏î‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏à‡∏°‡∏î‡∏¥‡∏ô
            this.dy = -this.dy * this.friction; // ‡πÄ‡∏î‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏ï‡∏¥‡∏î‡∏•‡∏ö) ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡πÅ‡∏£‡∏á‡∏•‡∏á
        }

        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á (‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤)
        if (this.x + this.size > canvas.width || this.x < 0) {
            this.dx = -this.dx * this.friction; // ‡πÄ‡∏î‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô
        }

        this.draw();
    }

    draw() {
        ctx.font = this.size + 'px Arial';
        ctx.fillText(this.text, this.x, this.y);
    }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤
function animate() {
    requestAnimationFrame(animate);
    
    // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (‡∏•‡∏ö‡∏†‡∏≤‡∏û‡πÄ‡∏Å‡πà‡∏≤)
    // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô "‡∏´‡∏≤‡∏á" ‡∏¢‡∏≤‡∏ß‡πÜ ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô ctx.fillStyle='rgba(...)'; ‡πÅ‡∏ö‡∏ö Matrix
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏ó‡∏∏‡∏Å‡∏•‡∏π‡∏Å‡∏Ç‡∏¢‡∏±‡∏ö
    for (let i = 0; i < balls.length; i++) {
        balls[i].update();
    }

    // ‡∏•‡∏ö‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏≠‡∏°‡∏Ñ‡πâ‡∏≤‡∏á‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏™‡∏ô‡∏•‡∏π‡∏Å)
    if (balls.length > 300) {
        balls.shift(); // ‡∏•‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å‡∏≠‡∏≠‡∏Å
    }
}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏±‡∏ö‡πÄ‡∏°‡∏≤‡∏™‡πå
window.addEventListener('mousemove', function(e) {
    balls.push(new Ball(e.x, e.y));
});

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏£‡∏±‡∏ß‡πÜ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å
window.addEventListener('mousedown', function(e) {
    for(let i=0; i<5; i++) { // ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ 5 ‡∏•‡∏π‡∏Å
        balls.push(new Ball(e.x, e.y));
    }
});

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
animate();